# Stapler-mini

![AppIcon_512x512@1x](https://github.com/user-attachments/assets/6a590d9d-824f-48ff-9ce2-6ee7d008d08b)

Stapler-miniはKarabiner-Elementsの設定ファイルを出力するjsonファイル出力アプリです。

直感的にキーボードのリマップ、レイヤー機能の再現、タップホールド、コンボをカスタマイズすることができます。

## カスタマイズの流れ

### Configurationの作成、名前をつける

左上の＋ボタンを押すとシートが表示されます。カスタマイズしたいキーボードの配列やサイズを合わせてからAdd　Configurationをクリックします。

### デバイスの編集

DeviceEditタブで元々のキーボードのIDや、元々のキーコードを変更することが可能です。デバイス右上の歯車ボタンをクリックするとデバイスに対してポップオーバーが表示されます。ここでデバイスごとにIDの編集や有効化無効化が行えます。
キーコードの編集は下に表示されているキーをドラッグ&ドロップか、クリックで選択されているキーボードキーに対して変更を加えることができます。もしくはキーボードキーをダブルクリックすることで入力監視モードに移ります。インジケーターが点滅している間に入力されたキーコードを注入することができます。
Stapler-miniでは3つのデバイスを一度にカスタマイズすることができます。大きな＋ボタンをクリックするとデバイスが有効になります。デバイス左上のーボタンをクリックすると無効にできます。例えば、レイヤー1のマウスの左クリックに好きなコマンドを割り当てたりできるのが利点です。デバイスを跨いでレイヤーのカスタマイズができる威力をお試しあれ。

### キーボードをリマップする
Remapタブではキーの配置などを好きにカスタマイズすることができます。下のキーをキーボードキーにドラッグ&ドロップ、選択されているキーボードキーにキーをクリックで注入、長押しでホールドに注入、キーボードキーをダブルクリックで入力監視状態に移行しキーボードの入力で注入してカスタマイズすることが可能です。

また、さまざまな条件に基づいてカスタムを分岐することが可能です。
#### レイヤー
→平行四辺形のボタンでレイヤーを切り替えてカスタマイズできます。レイヤーへの遷移はモーメンタリー、トグルキーがあるのでそれを任意のキーに割り当ててください。
おすすめはスペースキーの長押しにレイヤーモーメンタリーを割り当てすることです。親指で押しながら他の指でレイヤーのキーコードを発火できます。
#### アプリ、トラックパッドに触れている指の本数、IMEの状態
→Conditionをピッカーから変更してCondition1〜9ぶんの状態を追加でカスタマイズすることができます。それぞれに対して条件に必要なテキストフィールドを埋めることでその条件下のみで書き換えが行われるようになります。

#### タップホールドのカスタマイズ
ポップオーバーかサイドバーからタップホールドを有効にすることができます。
タップホールドとはタップとホールドで違うキーコードを割り当てることができる機能です。例えばTabキーはタップしか通常使いませんが、そのホールドを好きな修飾キーやレイヤー遷移キーにすることができるようになります。タップあるいはホールドしか使わないキーに対して使っていないタップとホールドに好きな機能を割り当てることができます。
タップホールドが有効になっているが片方しかカスタマイズされていない場合、出力時にはもう片方にも同じカスタマイズが入ります。

##### Chord
タップとホールドというよりは他のキーと押しているかどうかでタップとホールドどちらのキーコードを出力するかを決めるタイプです。他のキーと押せばホールド、そのキーのみの場合はタップのキーコードが出力されます。仕組み上ホールドには修飾キーとレイヤー遷移キー以外を入れるとどうしても誤動作が発生します。
##### Duration
閾値を境にタップとホールドのキーコードを分岐するタイプです。
サイドバーからThresholdを設定すれば一つ一つの閾値を変更することも可能ですし、全体で揃えて閾値を変更したい場合はKarabiner-Elements側で設定することができます。

##### マルチタップホールド
タップダンスのような機能です。・ーや、・・・などを好きなキーコードにカスタマイズできます。Chordタイプでは連打ホールドでタップに割り当てたキーコードをリピートできるようにすることができます。

### コンボのカスタマイズ
Comboタブではコンボをカスタマイズすることができます。コンボとはキー複数の同時押しに対して好きなキーを割り当てることができる機能です。＋ボタンを押してコンボを追加し、選択状態にした上でキーボードキーをクリックするとコンボの構成要素として登録されます。ハイライトされているキーボードキーの同時押しで割り当てたキー入力を発火できるような設定が出力できます。またRemapと同じようにレイヤーや、Condition、タップホールドのカスタマイズが可能です。

### マクロのカスタマイズ
MacroタブではRemap、Comboタブで割り当てできるマクロを定義することができます。
ここでのマクロとはキーコードの配列を指します。例えば⌘⇧left_arrow → ⌘X のようなマクロを作れば「文頭までのテキストを選択、カット」を一つのキーを押しただけで発火することが可能になります。

### 設定を出力する
実際に出力する前にはKarabiner-Elements側で新しくProfileを作っておくことを推奨します。右上のツールバーから出力ボタンを押すとシートが表示されます。キーコードのリージョンは他の外部キーボードを繋ぐ場合はそのキーボードのリージョンに合わせておくことを推奨、もしくはキーコードのわかりやすさからANSI。
Export to Karabiner-Elementsと進むとjsonファイルを保存する先を指定する画面になります。テキトーな場所に保存すると、そのファイルをKarabiner-Elements側でインポートする画面が開きます。Importと進みKarabiner-Elements側Complex ModificationsタブでAdd Predifined Rulesからインポートした設定をEnable Allとすればカスタムした内容にキーボードが書き換えされるようになるはずです。出力したjsonファイルは削除してしまって問題ありません。

## それぞれのタブについての細かいTips
準備中！
### Macro
### DeviceEdit
### Remap
### Combo



